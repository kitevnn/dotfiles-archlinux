* ğŸ”¨ Working in Proress(æ–‡æ¡£æ–½å·¥ä¸­ing.....)

** ğŸ’¡ MEME

[[./MEME/EmacsTheTrueEditor.png]]

** ğŸ“° ä¸€äº›è´Ÿè´£ä»»çš„è¯

è¯·çœŸçš„ä¸è¦æ»¥æŠ„æˆ‘ä¸ªäººçš„é…ç½®ï¼Œå¾ˆè´Ÿè´£ä»»åœ°è¯´è¿™å¹¶ä¸æ˜¯è¯´åŠé€€ä»€ä¹ˆçš„

æ›´åŠ é‡è¦çš„åŸå› ï¼Œåªæ˜¯å› ä¸ºç¬¦åˆä¸ªäººä¹ æƒ¯çš„ä¸ä¸€å®šä¼šé€‚åˆæ‚¨çš„ä¹ æƒ¯

è¿˜æ˜¯æ¨èæ‚¨å…ˆè§‚çœ‹ä¸€ä¸‹ [[https://www.bilibili.com/video/BV1Fb421v7ZV][daily tsoding - one thing every programmer must have]] è¿™ä¸ªè§†é¢‘

*ä»…ä¾›å‚è€ƒ*

** ğŸ‘ GNU Emacså¿«æ·é”®é£æ ¼

| åºå· | å¿«æ·é”®å‰ç¼€(prefix-key) | è§£é‡Šæ„ä¹‰            |
|------+-----------------------+--------------------|
|    1 | ~C-z C-z~             | *<custom>*         |
|    2 | ~C-z C-p~             | *<p>* rocess       |
|    3 | ~C-z C-s~             | *<s>* witch window |
|    4 | ~C-z C-t~             | *<t>* heme         |
|    5 | ~C-z C-b~             | *<b>* uffer        |
|    6 | ~C-z C-w~             | resize *<w>* indow |
|    7 | ~C-z C-d~             | *<d>* ashboard     |
|    8 | ~C-z C-x~             | te *<x>* t         |
|    9 | ~C-z C-n~             | de *<n>* ote       |
|   10 | ~C-z C-a~             | *<a>* genda        |
|   11 | ~C-z C-o~             | *<o>* rg-mode      |
|   12 | ~C-z C-m~             | e *<m>* ms         |

** ğŸ”‘ æœ‰è¶£çš„å®ç°

*** 1. GNU Emacsæ€»ä½¿ç”¨æ—¶é•¿

ä» ~2025å¹´ 01æœˆ 26æ—¥ æ˜ŸæœŸæ—¥ 13:55:28 CST~ é‡æ–°å¼€å§‹ç´¯è®¡

#+begin_quote
Accompanying With GNU Emacs: 191 hours, 17 minutes, 15 seconds
#+end_quote

å®ç°è¿‡ç¨‹(å±•ç¤ºä»£ç ï¼Œä»è€Œæ¥è¯æ˜æˆ‘è‡ªå·±å¹¶æ²¡æœ‰ä¹±å†™æ—¶é—´ä¸Šå»ï¼Œå› ä¸ºæ¯æ¬¡çš„æ—¶é—´éƒ½ä¾èµ–äº ~(emacs-uptime)~ æ­¤elå‡½æ•°æ¥è·å–)

*bashæ–¹é¢*
#+begin_src sh
  #!/bin/bash

  # åŸºæœ¬è·¯å¾„é…ç½®
  user="une"
  path1=".config/emacs/archive"
  path2=".config/emacs/elisp/site-lisp/sh"
  filename="uptime"

  # å­˜å‚¨æ–‡ä»¶è·¯å¾„
  file1="/home/${user}/${path1}/${filename}"
  file2="/home/${user}/${path2}/${filename}"

  # åˆå§‹åŒ–æ€»æ—¶é—´
  total_seconds=0

  # é€è¡Œè¯»å–æ–‡ä»¶å†…å®¹
  while IFS= read -r line; do
    # åŒ¹é…å¹¶æå–å°æ—¶ã€åˆ†é’Ÿå’Œç§’
    if [[ "$line" =~ Uptime:\ ([0-9]+)\ hours?,\ ([0-9]+)\ minutes?,\ ([0-9]+)\ seconds? ]]; then
      hours=${BASH_REMATCH[1]}
      minutes=${BASH_REMATCH[2]}
      seconds=${BASH_REMATCH[3]}
    elif [[ "$line" =~ Uptime:\ ([0-9]+)\ minutes?,\ ([0-9]+)\ seconds? ]]; then
      hours=0
      minutes=${BASH_REMATCH[1]}
      seconds=${BASH_REMATCH[2]}
    elif [[ "$line" =~ Uptime:\ ([0-9]+)\ seconds? ]]; then
      hours=0
      minutes=0
      seconds=${BASH_REMATCH[1]}
    else
      # å¦‚æœä¸åŒ¹é…ä»»ä½•å·²çŸ¥æ ¼å¼ï¼Œè·³è¿‡è¿™è¡Œ
      continue
    fi

    # å°†æ—¶é—´è½¬æ¢ä¸ºç§’
    total_seconds=$((total_seconds + hours * 3600 + minutes * 60 + seconds))

  done < "$file1"

  # å¯é€‰ï¼šå°†ç§’æ•°è½¬æ¢ä¸ºå°æ—¶:åˆ†é’Ÿ:ç§’ æ ¼å¼
  total_hours=$((total_seconds / 3600))
  remaining_minutes=$(((total_seconds % 3600) / 60))
  remaining_seconds=$((total_seconds % 60))

  # è¾“å‡ºæ€»æ—¶é—´
  echo "Accompanying With GNU Emacs: $total_hours hours, $remaining_minutes minutes, $remaining_seconds seconds"
  echo "Accompanying With GNU Emacs: $total_hours hours, $remaining_minutes minutes, $remaining_seconds seconds" > "$file2"  
#+end_src

*elispæ–¹é¢*
#+begin_src elisp
  ;; =======================================
  ;; è·¯å¾„å˜é‡ (~/.config/emacs/elisp/basic/basic-file.el)
  ;; =======================================  
  (defvar directory-site-lisp               "elisp/site-lisp/sh/")                     ; emacsé…ç½®æ–‡ä»¶è·¯å¾„çš„modelineéƒ¨åˆ†

  ;; =======================================
  ;; æ‰‹åŠ¨æ›´æ–°å·²ä½¿ç”¨çš„GNU Emacsç´¯åŠ æ—¶é•¿ (~/.config/emacs/elisp/custom/custom-defun.el)
  ;; =======================================
  (defun my-save-emacs-uptime ()
    "é€šè¿‡è®¾ç½®é’©å­hooksï¼Œåœ¨æ¯æ¬¡é€€å‡ºEmacsåï¼Œè‡ªåŠ¨ä¿å­˜emacs-uptimeæ•°æ®åˆ°æŒ‡å®šæ–‡ä»¶å†…"
    (let ((uptime (emacs-uptime)))
      (with-temp-buffer
        (insert (format "Uptime: %s\n" uptime))
        (append-to-file (point-min) (point-max)  (concat user-emacs-directory directory-emacs-archive "uptime")))))

  (defun my-show-emacs-uptime ()
    "é€šè¿‡site-lispçš„shè„šæœ¬å®ç°ï¼Œè·å–Emacsçš„ç´¯è®¡ä½¿ç”¨æ€»æ—¶é•¿"
    (interactive)
    (let ((uptime-output
           (string-trim (shell-command-to-string
                         (concat user-emacs-directory directory-site-lisp "calculate-uptime.sh")))))
      (insert uptime-output)))


  ;; =======================================
  ;; æ›´æ–° calculate-uptime.sh è„šæœ¬è¾“å‡ºçš„é’©å­ (~/.config/emacs/elisp/hooks/hooks-hook.el)
  ;; =======================================
  (add-hook 'kill-emacs-hook 'my-save-emacs-uptime)                            ; åœ¨é€€å‡ºEmacsæ—¶ä¿å­˜å½“å‰uptime  
#+end_src

*æˆ‘è‡ªå·±çš„æ”¹è¿›æ€è·¯*

å½“å‰å¿…é¡»é€€å‡ºå1ä¸ªEmacsè¿›ç¨‹åï¼Œæ‰èƒ½ç»Ÿè®¡æœ¬æ¬¡çš„ç´¯è®¡ä½¿ç”¨æ€»æ—¶é•¿ï¼Œè¿™æ˜¯å› ä¸ºä¿å­˜äº†çš„æ˜¯é€æ¸é€’å¢çš„emacs-uptimeï¼Œè€Œéå¢é‡

+ ä¿å­˜çš„æ˜¯å¢é‡emacs-uptime-DELTAï¼Œè€Œä¸æ˜¯é€æ¸é€’å¢çš„emacs-uptime

  #+begin_quote
  æŠ½è±¡ä¸€ä¸ªæ ¹æ® ~(emacs-uptime)~ çš„å˜é‡ï¼Œä½œä¸ºå¢é‡æ—¶é—´ ~(defvar emacs-uptime-delta "")~

  ä½¿å¾—æ¯æ¬¡æ‰§è¡Œå‡½æ•° ~my-save-emacs-uptime~ å

  èƒ½æ¨¡ä»¿emacs-uptimeçš„å­—ç¬¦ä¸²(å¦‚Uptime: 1 hours, 55 minutes, 33 seconds)

  ä¿å­˜åˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­

  (ä»¥åæœ‰ç©ºå†å¼„.....å› ä¸ºè¿™å‡ å¤©æˆ‘è‡ªå·±å·²ç»é…ç½®äº†æ¥è¿‘20å°æ—¶çš„GNU Emacsäº†......ä¸‹æ¬¡å†å¼„ä¸‹æ¬¡å†å¼„)
  #+end_quote

  
*** 2. åœ¨modelineä¸Šå±•ç¤º [è®®ç¨‹æ•°é‡] çš„ä¿¡æ¯

*å¯èƒ½å“ªé‡Œä¼šå‡ºç°ä¸€ç‚¹ç‚¹é”™è¯¯ï¼Œä½†å¤§è‡´ä¸Šçš„é€»è¾‘å°±æ˜¯è¿™æ ·*

#+begin_src elisp
  ;; ==============================================
  ;; ç”Ÿäº§æ•°æ®çš„è¿‡ç¨‹
  ;; ==============================================
  ;; å¿…è¦çš„å˜é‡ä¿¡æ¯
  (defvar file-org-agenda-files               "/home/user/directory-114514/1919810.org" "[æ–‡ä»¶]: å¿…é¡»æ˜¯orgæ–‡ä»¶ï¼Œå› ä¸ºéœ€è¦ä½¿ç”¨org-mode")
  (defvar modeline-agenda-todo-count 0)
  (defvar modeline-agenda-doing-count 0)
  (defvar modeline-agenda-wait-count 0)
  (defvar modeline-agenda-file-name "")

  ;; è®¾ç½®å‡½æ•°
  (defun kivnn/count-agenda-file-tasks (file-path)
    "æ›´æ–°æŒ‡å®šè·¯å¾„è®®ç¨‹æ–‡ä»¶çš„agendaä¿¡æ¯"
    (interactive)
    (setq modeline-agenda-todo-count 0)
    (setq modeline-agenda-doing-count 0)
    (setq modeline-agenda-wait-count 0)
    (setq modeline-agenda-file-name (file-name-nondirectory file-path))
    ;; æ‰“å¼€ä¸´æ—¶buffer
    (with-temp-buffer
      (insert-file-contents file-path)
      (goto-char (point-min))
      (while (re-search-forward org-heading-regexp nil t)
        (let ((headline (match-string 0)))
          (cond
           ((string-match-p "\\*+ TODO" headline) (setq modeline-agenda-todo-count (1+ modeline-agenda-todo-count)))
           ((string-match-p "\\*+ DOING" headline) (setq modeline-agenda-doing-count (1+ modeline-agenda-doing-count)))
           ((string-match-p "\\*+ WAIT" headline) (setq modeline-agenda-wait-count (1+ modeline-agenda-wait-count))))))))

  ;; è®©ä¸Šè¿°å‡½æ•°åªå¯¹ç‰¹å®šæŒ‡å®šæ–‡ä»¶ç”Ÿæ•ˆ
  ;; ä»è€Œç»Ÿè®¡æ‰€æœ‰çš„ "*+ TODOã€*+ DOINGã€*+ WAIT" çš„æ ‡é¢˜æ•°é‡
  ;; å¹¶æ›´æ–°åˆ° "modeline-agenda-todo-count modeline-agenda-doing-count modeline-agenda-wait-count" å˜é‡ä¸Š
  (defun kivnn/update-modeline-agenda-file-tasks ()
    "ç»Ÿè®¡æŒ‡å®šæ–‡ä»¶2025.orgçš„ä»»åŠ¡"
    (kivnn/count-agenda-file-tasks file-org-agenda-files))


  ;; ==============================================
  ;; å±•ç¤ºæ•°æ®çš„è¿‡ç¨‹
  ;; ==============================================
  ;; å°† "modeline-agenda-todo-count modeline-agenda-doing-count modeline-agenda-wait-count" å˜é‡è®¾ç½®åœ¨modelineä¸Š
  (defun kivnn/update-modeline-with-all-scripts ()
    "æ˜¾ç¤ºmodelineä¿¡æ¯"
    (setq global-mode-string
          (list
           "  "
           (format "ó°„’ TODO %d " modeline-agenda-todo-count)
           (format "ó±¿ DOING %d " modeline-agenda-doing-count)
           (format "ó°• WAIT %d " modeline-agenda-wait-count)
           "- î˜³ "
           modeline-agenda-file-name))
    (setq-default mode-line-format
                  '("%e"
                    ;; a lot of things                    
                    global-mode-string
                    ;; a lot of things
                    )))

  ;; è‡ªåŠ¨ç‰ˆ
  (run-at-time "0 sec" 1800  'kivnn/update-modeline-agenda-file-tasks)   ; æ¯30åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡file-org-agenda-fileså˜é‡ çš„æŒ‡å®šæ–‡ä»¶çš„ "*+ TODOã€*+ DOINGã€*+ WAIT" çš„æ ‡é¢˜æ•°é‡

  ;; æ‰‹åŠ¨ç‰ˆ
  (defun kivnn/update-modeline-all-information ()
    "æ‰‹åŠ¨æ›´æ–°çŠ¶æ€æ ä¸Šçš„æ‰€æœ‰ä¿¡æ¯"
    (interactive)
    (kivnn/update-modeline-agenda-file-tasks) ; æ‰‹åŠ¨è¯»å– file-org-agenda-fileså˜é‡ çš„æŒ‡å®šæ–‡ä»¶çš„ "*+ TODOã€*+ DOINGã€*+ WAIT" çš„æ ‡é¢˜æ•°é‡
    (kivnn/update-modeline-with-all-scripts)) ; ç„¶åæ›´æ–°modelineçŠ¶æ€æ 

  ;; è®¾ç½®å¿«æ·é”®
  (global-set-key (kbd "C-114514")                   'kivnn/update-modeline-output-agenda-tasks)   
#+end_src
